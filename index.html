<!DOCTYPE html>
<html>
<head>
	<title>Media Fetch Example</title>
</head>
<body>
	<h1>Media Fetch Example</h1>
	<p>Enter a search query below to fetch a random media file:</p>
	<form id="search-form">
		<label for="search-query">Search query:</label>
		<input type="text" id="search-query" name="search" required>
		<select id="search-type" name="type">
			<option value="image" selected>Image</option>
			<option value="video">Video</option>
		</select>
		<button type="submit">Search</button>
	</form>
	<div id="media-container"></div>

	<script>
		const form = document.querySelector("#search-form");
		const mediaContainer = document.querySelector("#media-container");

		form.addEventListener("submit", async (event) => {
			event.preventDefault();
			const searchQuery = encodeURIComponent(form.search.value.trim());
			const searchType = form.type.value;
			const mediaUrl = `/api/media?search=${searchQuery}&type=${searchType}`;
			const response = await fetch(mediaUrl);
			const contentType = response.headers.get("content-type");
			if (searchType === "image") {
				const img = document.createElement("img");
				img.src = URL.createObjectURL(await response.blob());
				mediaContainer.innerHTML = "";
				mediaContainer.appendChild(img);
			} else if (searchType === "video") {
				const video = document.createElement("video");
				video.src = URL.createObjectURL(await response.blob());
				video.controls = true;
				mediaContainer.innerHTML = "";
				mediaContainer.appendChild(video);
			}
		});
	</script>
</body>
</html>
